!function(){"use strict";var e="",t=e+"assets/images/character_frodo.jpg",a=e+"assets/images/enemy_spider.jpg",n={player:{name:"",avatar:"",wins:0,loses:0,health:100,maxHealth:100,attack:10,attackZones:1,defendZones:2,critChance:.2,critMultiplier:1.5},battle:{playerAttack:[],playerDefend:[],enemyAttack:[],enemyDefend:[],log:[]},enemy:{name:"Spider",avatar:a,health:80,maxHealth:80,attack:12,critChance:.25,critMultiplier:1.5,attackZones:2,defendZones:1},enemies:[{name:"Spider",avatar:a,health:80,maxHealth:80,attack:12,critChance:.25,critMultiplier:1.5,attackZones:2,defendZones:1},{name:"Troll",avatar:e+"assets/images/enemy_troll.jpg",health:120,maxHealth:120,attack:8,critChance:.1,critMultiplier:2,attackZones:1,defendZones:3},{name:"Knight",avatar:e+"assets/images/enemy_knight.jpg",health:100,maxHealth:100,attack:10,critChance:.15,critMultiplier:1.5,attackZones:1,defendZones:2},{name:"Sauron",avatar:e+"assets/images/enemy_sauron.jpg",health:150,maxHealth:150,attack:15,critChance:.15,critMultiplier:1.5,attackZones:2,defendZones:2}]};function c(){localStorage.setItem("notFightClubGame",JSON.stringify(n))}function l(){var e=localStorage.getItem("notFightClubGame");if(e){var t=JSON.parse(e);Object.assign(n,t)}}var r=e+"assets/images/character_gandalf.jpg",o=e+"assets/images/character_aragorn.jpg",s=e+"assets/images/character_legolas.jpg",i=e+"assets/images/cup.svg",d=e+"assets/images/lose.svg",u=null,m=null,p=null;function _(){var e=document.querySelector("[data-battle_log]");if(n.enemy.name)console.log("battleLog"),console.log(n.battle.log),n.battle.log.forEach(function(e){e.isCrit&&e.isBlocked?S(e):e.isBlocked?q(e):S(e)});else{var t=Math.floor(Math.random()*n.enemies.length);n.enemy=JSON.parse(JSON.stringify(n.enemies[t])),c()}C();var a=document.querySelector("[data-battle_controls_attack_btn]");a.disabled=!0;var l=document.querySelector("[data-battle_zone_attack]"),r=document.querySelector("[data-battle_zone_defence]"),o=l.querySelectorAll("input"),s=r.querySelectorAll("input");o.forEach(function(e){e.checked=!1}),s.forEach(function(e){e.checked=!1}),u&&l.removeEventListener("click",u),m&&r.removeEventListener("click",m);var _=n.player.attackZones,h=[];u=function(e){var t=e.target;if("LABEL"!==t.tagName){var a=l.querySelectorAll("input:checked").length;t.closest("[data-battle_zone_attack_radio]")&&(t.checked&&h.length<_&&h.push(t),t.checked||(t.checked=!1,h=h.filter(function(e){return e!=t})),a>_&&(h.shift().checked=!1,h.push(t))),v()}};var g=n.player.defendZones,y=[];function v(){_===h.length&g===y.length?a.disabled=!1:a.disabled=!0}m=function(e){var t=e.target;if("LABEL"!==t.tagName){var a=r.querySelectorAll("input:checked").length;t.closest("[data-battle_zone_defence_radio]")&&(t.checked&&y.length<g&&y.push(t),t.checked||(t.checked=!1,y=y.filter(function(e){return e!=t})),a>g&&(y.shift().checked=!1,y.push(t))),v()}},l.addEventListener("click",u),r.addEventListener("click",m),p&&a.removeEventListener("click",p),p=function(e){var t,a,l=[],r=[];h.forEach(function(e){l.push(e.dataset.battle_zone_attack_input)}),y.forEach(function(e){r.push(e.dataset.battle_zone_defence_input)}),(t=n.battle.playerAttack).push.apply(t,l),(a=n.battle.playerDefend).push.apply(a,r),function(){for(var e=0;n.battle.enemyAttack.length<n.enemy.attackZones;e++){var t=Math.floor(Math.random()*b.length);n.battle.enemyAttack.includes(b[t])||n.battle.enemyAttack.push(b[t])}}(),function(){for(var e=0;n.battle.enemyDefend.length<n.enemy.defendZones;e++){var t=Math.floor(Math.random()*b.length);n.battle.enemyDefend.includes(b[t])||n.battle.enemyDefend.push(b[t])}}(),c(),f(),n.battle.playerAttack=[],n.battle.playerDefend=[],n.battle.enemyAttack=[],n.battle.enemyDefend=[],c()},a.addEventListener("click",p);var b=["head","neck","body","belly","legs"];function f(){k("player"),k("enemy")}function k(e){var t,a;"player"===e?(t="player",a="enemy"):"enemy"===e&&(t="enemy",a="player");var c=t+"Attack",l=a+"Defend";n.battle[c].forEach(function(e){var c=n.player.critChance>Math.random(),r=c?Math.floor(n[t].attack*n[t].critMultiplier):n[t].attack,o="player"===t,s=o?"character":"enemy",i=o?"enemy":"character",d={attackerName:n[t].name,defenderName:n[a].name,attackZone:e,isCrit:c,damage:r,isBlocked:n.battle[l].includes(e),attackingCharacterSpan:s,defendingCharacterSpan:i,characterAttack:t,characterDefend:a};n.battle.log.push(d),d.isCrit&&d.isBlocked?S(d):d.isBlocked?q(d):S(d),function(e,t){n[e].health=n[e].health-t,C()}(d.characterDefend,r)})}function S(t){t.damage,t.characterDefend;var a=document.createElement("div");a.classList.add("battle__log-item"),a.innerHTML=function(e){var t=e.attackerName,a=e.defenderName,n=e.attackZone,c=e.isCrit,l=e.damage,r=e.isBlocked,o=e.attackingCharacterSpan,s=e.defendingCharacterSpan,i=n[0].toUpperCase()+n.slice(1);return c&&r?'\n            <span class="battle__log-item-'.concat(o,' battle__log-item-span" data-battle_log_character_span>').concat(t,'</span>\n            attacked\n            <span class="battle__log-item-').concat(s,' battle__log-item-span" data-battle_log_enemy_span>').concat(a,'</span>\n            to\n            <span class="battle__log-item-zone battle__log-item-span" data-battle_log_zone_span>').concat(i,'</span>\n            <span class="battle__log-item-').concat(s,' battle__log-item-span" data-battle_log_enemy_span>').concat(a,'</span>\n            tried to block but <span class="battle__log-item-').concat(o,' battle__log-item-span" data-battle_log_character_span>').concat(t,'</span> was very lucky and crit his opponent for <span class="battle__log-item-damage battle__log-item-span" data-battle_log_zone_span>').concat(l," damage</span>\n    "):c?'\n            <span class="battle__log-item-'.concat(o,' battle__log-item-span" data-battle_log_character_span>').concat(t,'</span>\n            attacked\n            <span class="battle__log-item-').concat(s,' battle__log-item-span" data-battle_log_enemy_span>').concat(a,'</span>\n            to\n            <span class="battle__log-item-zone battle__log-item-span" data-battle_log_zone_span>').concat(i,'</span>\n            and crit\n            <span class="battle__log-item-damage battle__log-item-span" data-battle_log_zone_span>').concat(l," damage</span>\n    "):'\n            <span class="battle__log-item-'.concat(o,' battle__log-item-span" data-battle_log_character_span>').concat(t,'</span>\n            attacked\n            <span class="battle__log-item-').concat(s,' battle__log-item-span" data-battle_log_enemy_span>').concat(a,'</span>\n            to\n            <span class="battle__log-item-zone battle__log-item-span" data-battle_log_zone_span>').concat(i,'</span>\n            and deal\n            <span class="battle__log-item-damage battle__log-item-span" data-battle_log_zone_span>').concat(l," damage</span>\n    ")}(t),e.append(a),e.scrollTop=e.scrollHeight}function q(t){t.attackerName,t.defenderName,t.attackZone;var a=document.createElement("div");a.classList.add("battle__log-item"),a.innerHTML=function(e){var t=e.attackerName,a=e.defenderName,n=e.attackZone,c=e.attackingCharacterSpan,l=e.defendingCharacterSpan,r=n[0].toUpperCase()+n.slice(1);return'\n            <span class="battle__log-item-'.concat(c,' battle__log-item-span" data-battle_log_character_span>').concat(t,'</span>\n            attacked\n            <span class="battle__log-item-').concat(l,' battle__log-item-span" data-battle_log_enemy_span>').concat(a,'</span>\n            to\n            <span class="battle__log-item-zone battle__log-item-span" data-battle_log_zone_span>').concat(r,'</span>\n            but <span class="battle__log-item-').concat(l,' battle__log-item-span" data-battle_log_enemy_span>').concat(a,'</span>\n            was able to <span class="battle__log-item-defend battle__log-item-span" data-battle_log_protect_span>protect</span>\n            his  <span class="battle__log-item-zone battle__log-item-span" data-battle_log_zone_span>').concat(r,"</span>\n    ")}(t),e.append(a),e.scrollTop=e.scrollHeight}function E(e){document.querySelector('[data-popup="results"]');var t=document.querySelector("[data-popup__title]"),a=document.createElement("img");a.classList.add("popup__results-icon"),"win"===e?(a.src=i,t.textContent="Congratulations with your win!",t.append(a),n.player.wins=n.player.wins+1,c(),L('[data-popup="results"]')):(a.src=d,t.textContent="Maybe next time",t.append(a),n.player.loses=n.player.loses+1,c(),L('[data-popup="results"]'))}function C(){var e=document.querySelector("[data-battle_character_avatar_img]"),t=document.querySelector("[data-battle_character_name]"),a=document.querySelector("[data-battle_character_current_health]"),c=document.querySelector("[data-battle_character_total_health]"),l=document.querySelector("[data-avatar_health_bg]"),r=document.querySelector("[data-enemy_health_bg]");e.src=n.player.avatar,t.textContent=n.player.name,n.player.health>0?(a.textContent=n.player.health,l.style.width="".concat(100*n.player.health/n.player.maxHealth,"%")):(a.textContent=0,l.style.width="0%",E("lose")),c.textContent=n.player.maxHealth;var o=document.querySelector("[data-battle_enemy_avatar_img]"),s=document.querySelector("[data-battle_enemy_name]"),i=document.querySelector("[data-battle_enemy_current_health]"),d=document.querySelector("[data-battle_enemy_total_health]");o.src=n.enemy.avatar,s.textContent=n.enemy.name,n.enemy.health>0?(i.textContent=n.enemy.health,r.style.width="".concat(100*n.enemy.health/n.enemy.maxHealth,"%")):(i.textContent=0,r.style.width="0%",E("win")),d.textContent=n.enemy.maxHealth}f()}function h(){n.player.health=n.player.maxHealth,n.enemy={},n.battle.log=[],document.querySelector("[data-battle_log]").textContent="",c()}var g=null,y=null,v=null,b=null,f=null,k=null,S=null;function L(e){var a=document.querySelector("body"),l=document.querySelector(e);l.querySelector("[data-popup_container]").animate([{opacity:"0"},{opacity:"1"}],{duration:400,fill:"forwards"}),l.classList.add("popup--active"),a.classList.add("lock");var i=document.querySelector('[data-avatar_name="frodo"]'),d=document.querySelector('[data-avatar_name="gandalf"]'),u=document.querySelector('[data-avatar_name="aragorn"]'),m=document.querySelector('[data-avatar_name="legolas"]');g&&l.removeEventListener("click",g),y&&i.removeEventListener("click",y),v&&d.removeEventListener("click",v),b&&u.removeEventListener("click",b),f&&m.removeEventListener("click",f),g=function(t){var a=t.target;a.closest(".popup__container")||(q(e),'[data-popup="results"]'===e&&(h(),_(),c())),a.closest(".popup__close")&&(q(e),'[data-popup="results"]'===e&&(h(),_(),c()))},y=function(e){n.player.avatar=t,w(),c()},v=function(e){n.player.avatar=r,w(),c()},b=function(e){n.player.avatar=o,w(),c()},f=function(e){n.player.avatar=s,w(),c()},l.addEventListener("click",g),i.addEventListener("click",y),d.addEventListener("click",v),u.addEventListener("click",b),m.addEventListener("click",f);var p=document.querySelector("[data-popup_results_btn_fight]"),L=document.querySelector("[data-popup_results_btn_character]");k&&p.removeEventListener("click",k),S&&L.removeEventListener("click",S);var E={register:document.querySelector('[data-screen="register"]'),home:document.querySelector('[data-screen="home"]'),character:document.querySelector('[data-screen="character"]'),settings:document.querySelector('[data-screen="settings"]'),battle:document.querySelector('[data-screen="battle"]')};S=function(e){q('[data-popup="results"'),h(),_(),w(),A("character",E),c()},k=function(e){q('[data-popup="results"'),h(),_(),c()},p.addEventListener("click",k),L.addEventListener("click",S)}function q(e){var t=document.querySelector(e);t.querySelector("[data-popup_container]").animate([{opacity:"1"},{opacity:"0"}],{duration:400,fill:"forwards"}).addEventListener("finish",function(){t.classList.remove("popup--active")})}var E=null,C=null,x=null,Z=null;function w(){document.querySelector('[data-popup="character_change"]');var e=document.querySelector("[data-character_edit_container]"),t=document.querySelector("[data-character_avatar]"),a=document.querySelector("[data-character_avatar_btn]"),c=document.querySelector("[data-character_avatar_img]"),l=document.querySelector("[data-character_name]"),r=document.querySelector("[data-result_wins]"),o=document.querySelector("[data-result_loses]");c.src=n.player.avatar,l.textContent=n.player.name,r.textContent=n.player.wins,o.textContent=n.player.loses;var s="character__avatar-edit-container--active";E&&t.removeEventListener("mouseover",E),C&&t.removeEventListener("mouseout",C),x&&e.removeEventListener("click",x),Z&&a.removeEventListener("click",Z),E=function(t){e.classList.add(s)},C=function(t){e.classList.remove(s)},x=function(e){L('[data-popup="character_change"]')},Z=function(e){L('[data-popup="character_change"]')},t.addEventListener("mouseover",E),t.addEventListener("mouseout",C),e.addEventListener("click",x),a.addEventListener("click",Z)}function z(){document.querySelector("[data-home_title_name]").textContent=n.player.name}var M=null,D=null;function A(e,t){var a,n=document.querySelector("[data-page_title]");Object.values(t).forEach(function(e){return e.classList.remove("active")}),t[e].classList.add("active"),n.textContent=(a=e)[0].toUpperCase()+a.slice(1)}window.addEventListener("DOMContentLoaded",function(){l(),function(){l();var e=document.querySelector('[data-screen="register"]'),a=document.querySelector('[data-screen="home"]'),r=document.querySelector('[data-screen="character"]'),o=document.querySelector('[data-screen="settings"]'),s=document.querySelector('[data-screen="battle"]'),i=document.querySelector('[data-screen="toolbar"]'),d=(document.querySelector("[data-page_title]"),{register:e,home:a,character:r,settings:o,battle:s}),u=document.querySelector("[data-register_btn]"),m=document.querySelector("[data-register_input]"),p=document.querySelector("[data-home_title_name]"),h=document.querySelector('[data-page_btn="home"]'),g=document.querySelector('[data-page_btn="character"]'),y=document.querySelector('[data-page_btn="settings"]'),v=document.querySelector('[data-page_btn="battle"]');n.player.name?(a.classList.add("active"),p.textContent=n.player.name,i.classList.add("active")):(e.classList.add("active"),n.player.avatar=t,i.classList.remove("active")),u.addEventListener("click",function(){var e=m.value.trim();n.player.name=e,i.classList.add("active"),c(),z(),A("home",d)}),m.addEventListener("input",function(e){e.target.value.length>=1?u.disabled=!1:u.disabled=!0}),h.addEventListener("click",function(e){e.preventDefault(),A("home",d),z()}),g.addEventListener("click",function(e){e.preventDefault(),A("character",d),w()}),y.addEventListener("click",function(e){e.preventDefault(),A("settings",d),function(){var e=document.querySelector("[data-settings_change_name]"),t=document.querySelector("[data-edit_change_name]"),a=document.querySelector("[data-settings_change_name_input]"),l=document.querySelector("[data-settings_change-name_current_name]");l.textContent=n.player.name;var r=n.player.name;M&&(t.removeEventListener("click",M),e.classList.remove("settings__change-name--active"),t.textContent="Edit",l.textContent=r),D&&a.removeEventListener("input",D),M=function(o){e.classList.contains("settings__change-name--active")?(e.classList.remove("settings__change-name--active"),t.textContent="Edit",l.textContent=r):(e.classList.add("settings__change-name--active"),t.textContent="Save",a.value=r),n.player.name=a.value.trim(),c()},D=function(e){var a=e.target;a.value?(t.disabled=!1,r=a.value.trim()):t.disabled=!0},t.addEventListener("click",M),a.addEventListener("input",D)}()}),v.addEventListener("click",function(e){e.preventDefault(),A("battle",d),_()})}()})}();