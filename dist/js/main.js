!function(){"use strict";var e="",t=e+"assets/images/character_frodo.jpg";const a={player:{name:"",avatar:"",wins:0,loses:0,health:100,maxHealth:100,attack:10,attackZones:1,defendZones:2,critChance:.2,critMultiplier:1.5},avatars:[{avatarName:"frodo",health:100,maxHealth:100,attack:10,attackZones:1,defendZones:2,critChance:.2,critMultiplier:1.5},{avatarName:"aragorn",health:100,maxHealth:100,attack:12,critChance:.15,critMultiplier:1.25,attackZones:2,defendZones:2},{avatarName:"legolas",health:80,maxHealth:80,attack:18,critChance:.25,critMultiplier:1.35,attackZones:2,defendZones:1},{avatarName:"gandalf",health:150,maxHealth:150,attack:15,critChance:.1,critMultiplier:1.15,attackZones:2,defendZones:2}],battle:{playerAttack:[],playerDefend:[],enemyAttack:[],enemyDefend:[],log:[]},enemy:{},enemies:[{name:"Spider",avatar:e+"assets/images/enemy_spider.jpg",health:80,maxHealth:80,attack:12,critChance:.25,critMultiplier:1.5,attackZones:2,defendZones:1},{name:"Troll",avatar:e+"assets/images/enemy_troll.jpg",health:120,maxHealth:120,attack:8,critChance:.1,critMultiplier:2,attackZones:1,defendZones:3},{name:"Knight",avatar:e+"assets/images/enemy_knight.jpg",health:100,maxHealth:100,attack:10,critChance:.15,critMultiplier:1.5,attackZones:1,defendZones:2},{name:"Sauron",avatar:e+"assets/images/enemy_sauron.jpg",health:150,maxHealth:150,attack:15,critChance:.15,critMultiplier:1.5,attackZones:2,defendZones:2}]};function n(){localStorage.setItem("notFightClubGame",JSON.stringify(a))}function l(){const e=localStorage.getItem("notFightClubGame");if(e){const t=JSON.parse(e);Object.assign(a,t)}}var c=e+"assets/images/character_gandalf.jpg",o=e+"assets/images/character_aragorn.jpg",s=e+"assets/images/character_legolas.jpg",r=e+"assets/icons/cup.svg",i=e+"assets/icons/lose.svg",d=e+"assets/sounds/click.mp3",m=e+"assets/sounds/fight.mp3",p=e+"assets/sounds/song.mp3";function u(e,t=.1){const a=new Audio;return a.src=e,a.volume=t,a}function _(e=.1){const t=document.querySelectorAll("[data-sound]"),a=u(d,e),n=u(m,e);t.forEach(e=>{const t=e.dataset.sound;e.addEventListener("click",e=>{"click"===t&&a.play(),"fight"===t&&n.play()})})}let h=null,g=!1;var y=e+"assets/sounds/win.mp3",v=e+"assets/sounds/lose.mp3";let b,k,f=null,S=null,L=null,w=!1;function E(){const e=document.querySelector("[data-battle_log]");if(a.enemy.name)a.battle.log.forEach(e=>{e.isCrit&&e.isBlocked?E(e):e.isBlocked?q(e):E(e)});else{const e=Math.floor(Math.random()*a.enemies.length);a.enemy=JSON.parse(JSON.stringify(a.enemies[e])),n()}x();const t=document.querySelector("[data-battle_controls_attack_btn]");t.disabled=!0;const l=document.querySelector("[data-battle_zone_attack]"),c=document.querySelector("[data-battle_zone_defence]"),o=l.querySelectorAll("input"),s=c.querySelectorAll("input");o.forEach(e=>{e.checked=!1}),s.forEach(e=>{e.checked=!1}),f&&l.removeEventListener("click",f),S&&c.removeEventListener("click",S);const d=a.player.attackZones;let m=[];f=e=>{const t=e.target;if("LABEL"===t.tagName)return;const a=l.querySelectorAll("input:checked").length;t.closest("[data-battle_zone_attack_radio]")&&(t.checked&&m.length<d&&m.push(t),t.checked||(t.checked=!1,m=m.filter(e=>e!=t)),a>d)&&(m.shift().checked=!1,m.push(t)),h()};const p=a.player.defendZones;let _=[];function h(){d===m.length&p===_.length?t.disabled=!1:t.disabled=!0}S=e=>{const t=e.target;if("LABEL"===t.tagName)return;const a=c.querySelectorAll("input:checked").length;t.closest("[data-battle_zone_defence_radio]")&&(t.checked&&_.length<p&&_.push(t),t.checked||(t.checked=!1,_=_.filter(e=>e!=t)),a>p)&&(_.shift().checked=!1,_.push(t)),h()},l.addEventListener("click",f),c.addEventListener("click",S),L&&t.removeEventListener("click",L),L=e=>{let t=[],l=[];m.forEach(e=>{t.push(e.dataset.battle_zone_attack_input)}),_.forEach(e=>{l.push(e.dataset.battle_zone_defence_input)}),a.battle.playerAttack.push(...t),a.battle.playerDefend.push(...l),function(){for(let e=0;a.battle.enemyAttack.length<a.enemy.attackZones;e++){const e=Math.floor(Math.random()*g.length);a.battle.enemyAttack.includes(g[e])||a.battle.enemyAttack.push(g[e])}}(),function(){for(let e=0;a.battle.enemyDefend.length<a.enemy.defendZones;e++){const e=Math.floor(Math.random()*g.length);a.battle.enemyDefend.includes(g[e])||a.battle.enemyDefend.push(g[e])}}(),n(),b(),a.battle.playerAttack=[],a.battle.playerDefend=[],a.battle.enemyAttack=[],a.battle.enemyDefend=[],n()},t.addEventListener("click",L);const g=["head","neck","body","belly","legs"];function b(){k("player"),a.enemy.health>=1&&k("enemy")}function k(e){let t,n;"player"===e?(t="player",n="enemy"):"enemy"===e&&(t="enemy",n="player");const l=t+"Attack",c=n+"Defend";a.battle[l].forEach(e=>{const l=a.player.critChance>Math.random(),o=l?Math.floor(a[t].attack*a[t].critMultiplier):a[t].attack,s="player"===t,r=s?"character":"enemy",i=s?"enemy":"character",d={attackerName:a[t].name,defenderName:a[n].name,attackZone:e,isCrit:l,damage:o,isBlocked:a.battle[c].includes(e),attackingCharacterSpan:r,defendingCharacterSpan:i,characterAttack:t,characterDefend:n};a.battle.log.push(d),d.isCrit&&d.isBlocked?E(d):d.isBlocked?q(d):E(d),function(e,t){a[e].health=a[e].health-t,x()}(d.characterDefend,o)})}function E(t){const{damage:a,characterDefend:n}=t,l=document.createElement("div");l.classList.add("battle__log-item"),l.innerHTML=function(e){const{attackerName:t,defenderName:a,attackZone:n,isCrit:l,damage:c,isBlocked:o,attackingCharacterSpan:s,defendingCharacterSpan:r}=e,i=n[0].toUpperCase()+n.slice(1);return l&&o?`\n            <span class="battle__log-item-${s} battle__log-item-span" data-battle_log_character_span>${t}</span>\n            attacked\n            <span class="battle__log-item-${r} battle__log-item-span" data-battle_log_enemy_span>${a}</span>\n            to\n            <span class="battle__log-item-zone battle__log-item-span" data-battle_log_zone_span>${i}</span>\n            <span class="battle__log-item-${r} battle__log-item-span" data-battle_log_enemy_span>${a}</span>\n            tried to block but <span class="battle__log-item-${s} battle__log-item-span" data-battle_log_character_span>${t}</span> was very lucky and crit his opponent for <span class="battle__log-item-damage battle__log-item-span" data-battle_log_zone_span>${c} damage</span>\n    `:l?`\n            <span class="battle__log-item-${s} battle__log-item-span" data-battle_log_character_span>${t}</span>\n            attacked\n            <span class="battle__log-item-${r} battle__log-item-span" data-battle_log_enemy_span>${a}</span>\n            to\n            <span class="battle__log-item-zone battle__log-item-span" data-battle_log_zone_span>${i}</span>\n            and crit\n            <span class="battle__log-item-damage battle__log-item-span" data-battle_log_zone_span>${c} damage</span>\n    `:`\n            <span class="battle__log-item-${s} battle__log-item-span" data-battle_log_character_span>${t}</span>\n            attacked\n            <span class="battle__log-item-${r} battle__log-item-span" data-battle_log_enemy_span>${a}</span>\n            to\n            <span class="battle__log-item-zone battle__log-item-span" data-battle_log_zone_span>${i}</span>\n            and deal\n            <span class="battle__log-item-damage battle__log-item-span" data-battle_log_zone_span>${c} damage</span>\n    `}(t),e.append(l),e.scrollTop=e.scrollHeight}function q(t){const{attackerName:a,defenderName:n,attackZone:l}=t,c=document.createElement("div");c.classList.add("battle__log-item"),c.innerHTML=function(e){const{attackerName:t,defenderName:a,attackZone:n,attackingCharacterSpan:l,defendingCharacterSpan:c}=e,o=n[0].toUpperCase()+n.slice(1);return`\n            <span class="battle__log-item-${l} battle__log-item-span" data-battle_log_character_span>${t}</span>\n            attacked\n            <span class="battle__log-item-${c} battle__log-item-span" data-battle_log_enemy_span>${a}</span>\n            to\n            <span class="battle__log-item-zone battle__log-item-span" data-battle_log_zone_span>${o}</span>\n            but <span class="battle__log-item-${c} battle__log-item-span" data-battle_log_enemy_span>${a}</span>\n            was able to <span class="battle__log-item-defend battle__log-item-span" data-battle_log_protect_span>protect</span>\n            his  <span class="battle__log-item-zone battle__log-item-span" data-battle_log_zone_span>${o}</span>\n    `}(t),e.append(c),e.scrollTop=e.scrollHeight}async function C(t){console.log(e.scrollHeight);const l=e.scrollTop;await ee("./views/popup_results.html");const c=document.querySelector("[data-battle_log]");c&&(c.scrollTop=l),document.querySelector('[data-popup="results"]');const o=document.querySelector("[data-popup__title]"),s=document.createElement("img");s.classList.add("popup__results-icon"),"win"===t?(s.src=r,o.textContent="Congratulations with your win!",o.append(s),a.player.wins=a.player.wins+1,n(),F('[data-popup="results"]'),u(y,.1).play()):(s.src=i,o.textContent="Maybe next time",o.append(s),a.player.loses=a.player.loses+1,n(),F('[data-popup="results"]'),u(v,.1).play())}function x(){const e=document.querySelector("[data-battle_character_avatar_img]"),t=document.querySelector("[data-battle_character_name]"),n=document.querySelector("[data-battle_character_current_health]"),l=document.querySelector("[data-battle_character_total_health]"),c=document.querySelector("[data-battle_attack_amount]"),o=document.querySelector("[data-battle_defence_amount]");c.textContent=a.player.attackZones,o.textContent=a.player.defendZones;const s=document.querySelector("[data-avatar_health_bg]"),r=document.querySelector("[data-enemy_health_bg]");e.src=a.player.avatar,t.textContent=a.player.name,a.player.health>=1?(n.textContent=a.player.health,s.style.width=100*a.player.health/a.player.maxHealth+"%"):(n.textContent=0,s.style.width="0%",w||(w=!0,C("lose"))),l.textContent=a.player.maxHealth;const i=document.querySelector("[data-battle_enemy_avatar_img]"),d=document.querySelector("[data-battle_enemy_name]"),m=document.querySelector("[data-battle_enemy_current_health]"),p=document.querySelector("[data-battle_enemy_total_health]");i.src=a.enemy.avatar,d.textContent=a.enemy.name,a.enemy.health>0?(m.textContent=a.enemy.health,r.style.width=100*a.enemy.health/a.enemy.maxHealth+"%"):(m.textContent=0,r.style.width="0%",w||(w=!0,C("win"))),p.textContent=a.enemy.maxHealth}b()}function q(){w=!1,a.player.health=a.player.maxHealth,a.enemy={},a.battle.log=[],document.querySelector("[data-battle_log]").textContent="",n()}async function C(){document.querySelector("[data-home_title_name]").textContent=a.player.name}async function x(){const e=document.querySelector("[data-register_btn]"),t=document.querySelector("[data-register_input]");b&&e&&e.removeEventListener("click",b),k&&t&&t.removeEventListener("input",k),b=async e=>{a.player.name=t.value,n(),await z(e),await C(),await D()},k=t=>{t.target.value.length>=1?e.disabled=!1:e.disabled=!0},e&&t&&(e.addEventListener("click",b),t.addEventListener("input",k))}let Z=null,$=null;function M(){const e=document.querySelector("[data-settings_change_name]"),t=document.querySelector("[data-edit_change_name]"),l=document.querySelector("[data-settings_change_name_input]"),c=document.querySelector("[data-settings_change-name_current_name]");c.textContent=a.player.name;let o=a.player.name;Z&&(t.removeEventListener("click",Z),e.classList.remove("settings__change-name--active"),t.textContent="Edit",c.textContent=o),$&&l.removeEventListener("input",$),Z=s=>{e.classList.contains("settings__change-name--active")?(e.classList.remove("settings__change-name--active"),t.textContent="Edit",c.textContent=o):(e.classList.add("settings__change-name--active"),t.textContent="Save",l.value=o),a.player.name=l.value.trim(),n()},$=e=>{const a=e.target;a.value?(t.disabled=!1,o=a.value.trim()):t.disabled=!0},t.addEventListener("click",Z),l.addEventListener("input",$)}const H={"/register":"/views/register.html","/index.html":"/views/home.html","/":"/views/home.html","/home":"/views/home.html","/character":"/views/character.html","/settings":"/views/settings.html","/battle":"/views/battle.html"},z=async e=>{const t=e.target.dataset.link;window.history.pushState({},"",t),await N()},A=e=>{window.history.pushState({},"",e)},N=async()=>{const e=window.location.pathname,t=H[e]||"/home";"/"===e&&(A("/home"),X()),"/index.html"===e&&(A("/home"),X()),H[e]||(A("/home"),X());const a=await fetch(t).then(e=>e.text()),n=await fetch("./views/toolbar.html").then(e=>e.text());document.getElementById("root").innerHTML=a,document.getElementById("root").innerHTML+=n;let l={"/":C,"/index.html":C,"/home":C,"/register":x,"/character":W,"/settings":M,"/battle":E}[e];l?l():l=C,D(),_(.05)};async function D(){document.querySelectorAll("[data-link]").forEach(e=>{e.dataset.link,e.addEventListener("click",async t=>{await z(t);const a=e.dataset.page_btn;var n;document.querySelector("[data-page_title]").textContent=(n=a)[0].toUpperCase()+n.slice(1)})})}window.addEventListener("popstate",N);let B=null,T=null,j=null,I=null,O=null,J=null,U=null;async function F(e){const l=document.querySelector("body"),r=document.querySelector(e);r.querySelector("[data-popup_container]").animate([{opacity:"0"},{opacity:"1"}],{duration:400,fill:"forwards"}),r.classList.add("popup--active"),l.classList.add("lock");const i=document.querySelector('[data-avatar_name="frodo"]'),d=document.querySelector('[data-avatar_name="gandalf"]'),m=document.querySelector('[data-avatar_name="aragorn"]'),p=document.querySelector('[data-avatar_name="legolas"]');B&&r.removeEventListener("click",B),T&&i&&i.removeEventListener("click",T),j&&d&&d.removeEventListener("click",j),I&&m&&m.removeEventListener("click",I),O&&p&&p.removeEventListener("click",O),B=t=>{const a=t.target;a.closest(".popup__container")||(G(e),'[data-popup="results"]'===e&&(q(),E(),n())),a.closest(".popup__close")&&(G(e),'[data-popup="results"]'===e&&(q(),E(),n()))},T=e=>{a.player.avatar=t,K("frodo"),W(),n(),G('[data-popup="character_change"]')},j=e=>{a.player.avatar=c,K("gandalf"),W(),n(),G('[data-popup="character_change"]')},I=e=>{a.player.avatar=o,K("aragorn"),W(),n(),G('[data-popup="character_change"]')},O=e=>{a.player.avatar=s,K("legolas"),W(),n(),G('[data-popup="character_change"]')},r.addEventListener("click",B),i&&d&&m&&p&&(i.addEventListener("click",T),d.addEventListener("click",j),m.addEventListener("click",I),p.addEventListener("click",O));const u=document.querySelector("[data-popup_results_btn_fight]"),_=document.querySelector("[data-popup_results_btn_character]");J&&u&&u.removeEventListener("click",J),U&&_&&_.removeEventListener("click",U),U=async e=>{G('[data-popup="results"'),q(),E(),await Y("./views/character.html"),await ee("./views/toolbar.html"),W(),n()},J=e=>{G('[data-popup="results"'),q(),E(),n()},u&&_&&(u.addEventListener("click",J),_.addEventListener("click",U))}function G(e){const t=document.querySelector(e),a=t.querySelector("[data-popup_container]").animate([{opacity:"1"},{opacity:"0"}],{duration:400,fill:"forwards"}),n=document.querySelector('[data-popup="character_change"]');a.addEventListener("finish",()=>{t.classList.remove("popup--active"),t.remove(),n&&W(),D()})}function K(e){const t=a.avatars.find(t=>t.avatarName===e);a.player.attack=t.attack,a.player.attackZones=t.attackZones,a.player.defendZones=t.defendZones,a.player.critChance=t.critChance,a.player.critMultiplier=t.critMultiplier,a.player.maxHealth=t.maxHealth,a.player.health>t.maxHealth&&(a.player.health=t.health),n()}let P=null,Q=null,R=null,V=null;function W(){document.querySelector('[data-popup="character_change"]');const e=document.querySelector("[data-character_edit_container]"),t=document.querySelector("[data-character_avatar]"),n=document.querySelector("[data-character_avatar_btn]"),l=document.querySelector("[data-character_avatar_img]"),c=document.querySelector("[data-character_name]"),o=document.querySelector("[data-result_wins]"),s=document.querySelector("[data-result_loses]");l.src=a.player.avatar,c.textContent=a.player.name,o.textContent=a.player.wins,s.textContent=a.player.loses;const r="character__avatar-edit-container--active";e.classList.remove(r),P&&t.removeEventListener("mouseover",P),Q&&t.removeEventListener("mouseout",Q),R&&e.removeEventListener("click",R),V&&n.removeEventListener("click",V),P=t=>{e.classList.add(r)},Q=t=>{e.classList.remove(r)},R=async e=>{await ee("./views/popup_character.html"),await F('[data-popup="character_change"]')},V=async e=>{await ee("./views/popup_character.html"),await F('[data-popup="character_change"]')},t.addEventListener("mouseover",P),t.addEventListener("mouseout",Q),e.addEventListener("click",R),n.addEventListener("click",V)}async function X(){l(),a.player.name?(await Y("./views/home.html"),await ee("./views/toolbar.html"),await D(),await C(),N()):(a.player.avatar=t,await Y("./views/register.html"),await x(),A("/register"))}async function Y(e){const t=await fetch(e).then(e=>e.text());document.getElementById("root").innerHTML=t,_(.05)}async function ee(e){const t=await fetch(e).then(e=>e.text());document.getElementById("root").innerHTML+=t,_(.05)}!function(e=.025){h||(h=u(p,e),h.loop=!0)}(),window.addEventListener("DOMContentLoaded",()=>{function e(){g=!0,h&&g&&h.play(),document.removeEventListener("click",e),document.removeEventListener("touchstart",e)}l(),X(),document.addEventListener("click",e,{once:!0}),document.addEventListener("touchstart",e,{once:!0})})}();